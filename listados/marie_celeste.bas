1 ’ <<<<< Marie Celeste >>>>>>>>
2 REM
500 GOTO 29000
1000 RESTORE 1200
1010 FOR n=1 TO 6
1020 FOR m=2 TO 40
1030 READ a:LOCATE m,n
1040 PRINT CHR$(a);
1050 NEXT m
1060 NEXT n
1100 RETURN
1200 DATA 158,154,158,154,156,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,150,154,156,32,32,32,156,32,32,32,32,32,32,149,32,32,32,32,32
1210 DATA 149,32,149,32,149,32,32,32,32,32,32,32,32,227,32,32,32,32,32,32,149,32,149,32,32,32,149,32,32,32,32,32,32,32,151,154,32,32,32,32
1220 DATA 149,32,149,32,149,32,150,154,156,32,158,154,156,158,32,150,154,156,32,32,149,32,32,150,154,156,149,150,154,156,150,154,156,149,32,150,154,156,32
1230 DATA 149,32,149,32,149,32,32,32,149,32,149,32,32,149,32,151,154,153,32,32,149,32,32,151,154,153,149,151,154,153,149,151,154,153,32
1240 DATA 149,32,149,32,149,32,150,154,157,32,149,32,32,149,32,149,32,32,32,32,149,32,32,149,32,32,149,149,32,32,147,154,156,149,32,149,32,32,32
1250 DATA 155,32,155,32,155,32,147,154,155,32,155,32,32,155,32,147,154,153,32,32,147,154,153,147,154,153,155,147,154,153,147,154,153,147,153,147,154,153
1500 RETURN
19980 ' >>>>>>> PANTALLA <<<<<<<<<
20000 INK 0,3:INK 1,20:INK 2,0:INK 3,24
20010 MODE 1
20020 BORDER 0:PAPER 2:PEN 3:CLS
20030 WINDOW #1,1,30,8,16
20040 WINDOW #2,1,30,17,25
20050 WINDOW #3,31,40,8,25
20060 PAPER #1,0:PEN #1,1:CLS #1
20070 PAPER #2,2:PEN #2,3:CLS #2
20080 PAPER #3,3:PEN #3,0:CLS #3
20100 RETURN
20980 '<<<<<< inicializacion >>>>>>
21000 DIM d(10,7)
21010 DIM o$(11)
21020 DIM m(10,4)
21030 DIM o(11)
21100 RESTORE 21200
21110 FOR n=1 TO 10
21120 READ d(n,1),d(n,2),d(n,3),d(n,4)
21125 READ d(n,5),d(n,6),d(n,7)
21130 READ m(n,1),m(n,2),m(n,3),m(n,4)
21140 NEXT n
21150 FOR n=1 TO 11
21160 READ o$(n),o(n)
21170 NEXT n
21180 RETURN
21200 DATA 1,8,10,11,20,0,0
21205 DATA 0,0,0,0
21210 DATA 12,36,23,0,0,0,0
21215 DATA 1,1,0,0
21220 DATA 13,16,1,29,4,30,20
21225 DATA 1,0,1,0
21230 DATA 3,13,14,23,0,0,0
21235 DATA 0,1,1,0
21240 DATA 1,18,33,30,3,0,0
21245 DATA 0,1,0,0
21250 DATA 1,8,9,11,20,0,0
21255 DATA 0,0,0,0
21260 DATA 2,30,20,13,15,22,16
21265 DATA 1,0,1,1
21270 DATA 5,30,20,0,0,0,0
21275 DATA 0,0,1,0
21280 DATA 1,8,34,29,5,0,0
21285 DATA 1,0,0,1
21290 DATA 33,3,27,1,17,0,0
21295 DATA 0,0,1,0
21300 DATA CUCHILLO,6
21310 DATA LONA,1
21320 DATA AGUA EN CUBIERTA,2
21330 DATA CUERDA,6
21340 DATA CARTEL,8
21350 DATA CUBO,4
21360 DATA LLAVE,0
21370 DATA GATO,9
21380 DATA TRAPO,5
21390 DATA BOTAS DE AGUA,5
21400 DATA GANCHOS,0
21980 ' <<<<<< entrada >>>>>>>>
22000 m$="":PRINT #2:PRINT #2,">";
22010 a$=INKEY$:a$=UPPER$(a$)
22020 IF (a$<"A" OR a$>"Z") AND a$<>" " AND a$<>CHR$(13) AND a$<>CHR$(127) THEN GOTO 22010
22030 SOUND 1,150,2,15
22035 IF a$=CHR$(127) AND m$="" THEN GOTO 22010
22040 IF a$=CHR$(127) THEN m$=LEFT$(m$,LEN(m$)-1):PRINT #2,CHR$(8);" ";CHR$(8);:GOTO 22010
22050 IF a$=CHR$(13) THEN PRINT #2,CHR$(13):RETURN
22060 m$=m$+a$
22070 PRINT #2,a$;
22080 GOTO 22010
22980 REM <<<<<<<< inventario >>>>>>>>>>
23000 CLS #3
23010 PRINT #3,"INVENTARIO";
23020 PRINT #3,"=========="
23030 PRINT #3:PRINT #3
23040 FOR n=1 TO 11
23050 IF o(n)=13 THEN PRINT #3,o$(n)
23060 NEXT n
23070 RETURN
23980 REM <<<<<<<<<< split >>>>>>>>>>>>
24000 v$="":n$=""
24010 FOR n=1 TO LEN(m$)
24020 IF MID$(m$,n,1)=" " THEN GOTO 24060
24030 NEXT n
24040 v$=m$
24050 RETURN
24060 v$=LEFT$(m$,n-1)
24070 N$=RIGHT$(m$,LEN(m$)-n)
24080 RETURN
24980 REM <<<<<<<< comandos >>>>>>>>>
25000 GOSUB 22000
25010 GOSUB 24000
25020 C$=LEFT$(v$,2)
25030 IF C$="BA" THEN GOSUB 30000
25040 IF C$="ES" THEN GOSUB 31000
25050 IF C$="PR" THEN GOSUB 32000
25060 IF C$="PO" THEN GOSUB 33000
25080 IF C$="EN" OR C$="IR" THEN GOSUB 35000
25090 IF C$="EX" OR C$="MI" OR C$="IN" THEN GOSUB 36000
25100 IF C$="AB" THEN GOSUB 37000
25120 IF C$="SU" THEN GOSUB 39000
25130 IF C$="MA" OR C$="AS" THEN GOSUB 40000
25140 IF C$="LO" THEN GOSUB 40500
25150 IF C$="FU" OR C$="BE" OR C$="EM" THEN GOSUB 41000
25160 C$=LEFT(V$,3)
25170 IF C$="FRE" OR C$="LIM" THEN GOSUB 42000
25180 IF C$="MOV" OR C$="ALZ" THEN GOSUB 43000
25185 IF C$="COR" THEN GOSUB 38000
25187 IF C$="COG" THEN GOSUB 34000
25190 IF V$="FIN" THEN GOSUB 44000
25200 IF v$="^" THEN GOTO 25220
25210 PRINT #2,"No entiendo..."
25220 GOSUB 28000:GOSUB 23000
25230 GOTO 25000
25980 REM <<<<<<< comienzo >>>>>>>>>
26000 GOSUB 27000
26010 GOSUB 20000
26015 GOSUB 1000
26020 GOSUB 21000
26030 GOSUB 23000
26040 po=6
26100 RETURN
26980 REM <<<<<<<< cadenas >>>>>>>>>
27000 DIM w$(36)
27010 RESTORE 27060
27020 FOR n=1 TO 36
27030 READ w$(n)
27040 NEXT n
27050 RETURN
27060 DATA ESTOY,POPA,PROA,BABOR,ESTRIBOR,ARRIBA,ABAJO,EN,UN,PEQUEÑO,GRAN
27070 DATA "BOTE, AL LADO DE EL",HAY,EL VIENTO,AULLA,ULULA
27080 DATA SUENA COMO RISA.,FUERA,DENTRO,ES, MARIA CELESTE
27090 DATA UN,Y,AQUI.,Y YO,ME DESLIZO,A TRAVÉS,CERRADOS,ABIERTOS,HACIA,DE,ES,YO VEO ,ALMACENES
27100 DATA BOQUETE,EL,AGUA EN CUBIERTA,DIABLO,TRIANGULO DE LAS BERMUDAS,ATLANTIS
27980 REM <<<<<<<< describir >>>>>>>>>>
28000 CLS #1
28005 IF po=2 AND o(10)<>13 THEN PRINT #2,"Te deslizas hacia la siguiente":PRINT #2,"sección de cubierta !":po=3:SOUND 2,300,10,15
28007 IF po=1 AND o(2)=0 THEN GOTO 45000
28010 FOR n=1 TO 7
28020 PRINT #1,w$(d(po,n));" ";
28030 NEXT n
28040 PRINT #1
28050 PRINT #1
28060 PRINT #1," Puedo ver -"
28070 FOR n=1 TO 11
28080 IF o(n)=po THEN PRINT #1,o$(n);",";
28090 NEXT n
28100 RETURN
28980 REM <<<<<< comienzo de juego >>>>>>>>>
29000 GOSUB 26000
29010 GOSUB 28000
29020 GOTO 25000
29980 REM <<<<<<<< comandos >>>>>>>>
30000 v$="^"
30010 IF m(po,4)<>0 THEN GOTO 30020
30015 PRINT #2,"No puedes ir por ahí.":RETURN
30020 IF m(po,4)=1 THEN po=po-5:RETURN
30030 a=m(po,4):a=a-1:IF o(a)=13 THEN PRINT #2,"Usas ";o$(a):PRINT #2,"y vas hacia babor." ELSE GOTO 30015
30040 FOR n=1 TO 3000: NEXT n
30050 po=po-5:RETURN
31000 v$="^"
31010 IF m(po,2)<>0 THEN GOTO 31020
31015 PRINT #2,"No puedes ir por ahí.":RETURN
31020 IF m(po,2)=1 THEN po=po+5:RETURN
31030 a=m(po,2):a=a-1:IF o(a)=13 THEN PRINT #2,"Usas ";o$(a):PRINT #2,"y vas hacia estribor." ELSE GOTO 31015
31040 FOR n=1 TO 3000:NEXT n
31050 po=po+5:RETURN
32000 v$="^"
32010 IF m(po,1)<>0 THEN GOTO 32020
32015 PRINT #2,"No puedes ir por ahí.":RETURN
32020 IF m(po,1)=1 THEN po=po+1:RETURN
32030 a=m(po,1):a=a-1:IF o(a)=13 THEN PRINT #2,"Usas ";o$(a):PRINT #2,"y vas hacia proa." ELSE GOTO 32015
32040 FOR n=1 TO 3000: NEXT n
32050 po=po+1:RETURN
33000 v$="^"
33010 IF m(po,3)<>0 THEN GOTO 33020
33015 PRINT #2,"no puedes ir por ahí.":RETURN
33020 IF m(po,3)=1 THEN po=po-1:RETURN
33030 a=m(po,3):a=a-1:IF o(a)=13 THEN PRINT #2,"Usas ";o$(a):PRINT #2,"y vas hacia popa." ELSE GOTO 33015
33040 FOR n=1 TO 3000:NEXT n
33050 po=po-1:RETURN
34000 v$="^"
34010 FOR n=1 TO 10
34020 IF n$=o$(n) THEN GOTO 34060
34030 NEXT n
34040 PRINT #2,"¡No seas tonto!"
34050 RETURN
34060 IF n=4 THEN PRINT #2"¡Está atada demasiado fuerte   para mí!":RETURN
34070 o(n)=13
34080 PRINT #2,"Coges el/la ";o$(n)
34090 RETURN
35000 v$="^"
35010 IF n$<>"ALMACÉN" AND n$<> "ALMACENES" THEN PRINT #2,"No puedes ir ahí...":RETURN
35020 IF m(10,4)=0 THEN PRINT #2,"¡Está cerrado!":RETURN
35030 po=5:RETURN
36000 v$="^"
36010 FOR n=1 TO 11
36020 IF n$=o$(n) THEN GOTO 36060
36030 NEXT n
36040 PRINT #2,"No veo eso aquí."
36050 RETURN
36060 IF n=1 THEN PRINT #2,"¡Es afilado!"
36070 IF n=2 THEN PRINT #2,"¡Es verde!"
36080 IF n=3 THEN PRINT #2,"¡Es húmeda y salada!"
36090 IF n=4 THEN PRINT #2,"¡Está atada fuertemente!"
36100 IF n=5 THEN PRINT #2,"Dice -":PRINT #2,"'No hay necesidad de ir debajo":PRINT #2,"de las cubiertas en este juego.'"
36110 IF n=6 AND o(7)=0 THEN PRINT #2,"¡Hace ruido!":o(7)=po
36120 IF n=6 AND o(7)<>0 THEN PRINT #2,"¡Está vacío!"
36130 IF n=7 THEN PRINT #2,"Dice 'ALMACÉN'"
36140 IF n=8 THEN PRINT #2,"Se escapa con una rata muerta.":o(8)=0
36150 IF n=9 THEN PRINT #2,"¡Estás empapado!"
36160 IF n=10 THEN PRINT #2,"¡Apestan!"
36170 IF n=11 THEN PRINT #2,"¡Parecen ser para una cuerda!"
36180 RETURN
37000 v$="^"
37010 IF po<>10 THEN PRINT #2,"No puedo...":RETURN
37020 IF o(7)<>13 THEN PRINT #2,"¡No tengo llave!":RETURN
37030 m(po,4)=1:PRINT #2,"El almacén está abierto."
37040 d(10,3)=28:RETURN
38000 v$="^":IF o(1)<>13 THEN PRINT #2,"¿Con qué?":RETURN
38010 IF n$=o$(4) THEN GOTO 38040
38020 PRINT #2,"¡Sádico!"
38030 RETURN
38040 PRINT #2,"Cortas la cuerda y la coges."
38050 o(4)=13
38060 RETURN
39000 v$="^":IF n$<>o$(4) THEN v$="BI":RETURN
39010 IF o(4)<>po AND o(4)<>13 THEN PRINT #2,"¿Dónde está la escalera?":RETURN
39020 PRINT #2,"Subes por la escalera de cuerda."
39030 IF po=6 THEN po=7:o(4)=7:RETURN
39040 IF po=7 THEN po=6:o(4)=6:RETURN
39050 IF po=1 THEN po=2:o(4)=2:RETURN
39060 RETURN
40000 PRINT #2,"Un albatros vuela hacia ti..."
40010 PRINT #2,"y te ataca por "
40020 PRINT #2,"ser destructivo."
40030 PRINT #2,"¡Estás muerto!"
40040 FOR n=1 TO 5000
40050 NEXT n
40060 SOUND 1,350,10,15
40070 GOTO 44000
40500 v$="^"
40510 PRINT #2:PRINT #2,"LAS SALIDAS SON:";
40520 IF m(po,1)<>0 THEN PRINT #2,"PROA ";
40530 IF m(po,3)<>0 THEN PRINT #2,"POPA ";
40540 IF m(po,2)<>0 THEN PRINT #2,"ESTRIBOR ";
40550 IF m(po,4)<>0 THEN PRINT #2,"BABOR."
40560 IF m(po,1)=0 AND m(po,2)=0 AND m(po,3)=0 AND m(po,4)=0 THEN PRINT #2,"NINGUNA."
40570 PRINT #2
40580 RETURN
41000 v$="^"
41010 PRINT #2,"¡Ahora no, marinero!"
41050 RETURN
42000 v$="^"
42010 IF o(6)<>13 OR o(9)<>13 THEN PRINT #2,"¿Con qué, loco...?":RETURN
42020 IF po<> THEN PRINT #2,"¡aquí no, campeón...!":RETURN
42030 o(3)=0:PRINT #2,"¡Bien hecho! ¡Ahora está limpio!":m(2,3)=5
42040 d(2,1)=1:d(2,2)=2:d(2,3)=20:d(2,4)=32:d(2,5)=21:d(2,6)=11:d(2,7)=0
42050 o(11)=2:RETURN
43000 v$="^"
43010 FOR n=1 TO 10
43020 IF n$=o$(n) THEN GOTO 43060
43030 NEXT n
43040 PRINT #2,"¿Mover qué?"
43050 RETURN
43060 PRINT #2,"¡Lo mueves y el"
43070 PRINT #2,"viento se lo lleva!"
43080 o(n)=0
43090 RETURN
44000 CLS #3:CLS #2
44010 PRINT #2,"¿Otra partida?"
44020 GOSUB 22000
44030 IF m$="Sí" THEN RETURN
44040 PRINT #2,"¡De todas maneras estás jugando!"
44050 FOR n=1 TO 25000
44060 NEXT n
44070 RETURN
45000 CLS #1
45010 PRINT #1,"¡SORPRESA!": PRINT #1,"Estamos escondidos en ";w$(21);" ";w$(11);" ";w$(20)
45020 PRINT #1,"¡Creíamos que NUNCA"
45030 PRINT #1,"resolverías la aventura!"
45040 GOTO 44000
