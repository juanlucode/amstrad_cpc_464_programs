1 ’ <<<<< Marie Celeste >>>>>>>>
2 REM
500 GOTO 29000
1000 RESTORE 1200
1010 FOR n=1 TO 6
1020 FOR m=2 TO 40
1030 READ a:LOCATE m,n
1040 PRINT CHR$(a);
1050 NEXT m
1060 NEXT n
1100 RETURN
1200 DATA 158,154,158,154,156,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,150,154,156,32,32,32,156,32,32,32,32,32,32,149,32,32,32,32,32
1210 DATA 149,32,149,32,149,32,32,32,32,32,32,32,32,227,32,32,32,32,32,32,149,32,149,32,32,32,149,32,32,32,32,32,32,32,151,154,32,32,32,32
1220 DATA 149,32,149,32,149,32,150,154,156,32,158,154,156,158,32,150,154,156,32,32,149,32,32,150,154,156,149,150,154,156,150,154,156,149,32,150,154,156,32
1230 DATA 149,32,149,32,149,32,32,32,149,32,149,32,32,149,32,151,154,153,32,32,149,32,32,151,154,153,149,151,154,153,149,151,154,153,32
1240 DATA 149,32,149,32,149,32,150,154,157,32,149,32,32,149,32,149,32,32,32,32,149,32,32,149,32,32,149,149,32,32,147,154,156,149,32,149,32,32,32
1250 DATA 155,32,155,32,155,32,147,154,155,32,155,32,32,155,32,147,154,153,32,32,147,154,153,147,154,153,155,147,154,153,147,154,153,147,153,147,154,153
1500 RETURN
19980 ' >>>>>>> PANTALLA <<<<<<<<<
20000 INK 0,3:INK 1,20:INK 2,0:INK 3,24
20010 MODE 1
20020 BORDER 0:PAPER 2:PEN 3:CLS
20030 WINDOW #1,1,30,8,16
20040 WINDOW #2,1,30,17,25
20050 WINDOW #3,31,40,8,25
20060 PAPER #1,0:PEN #1,1:CLS #1
20070 PAPER #2,2:PEN #2,3:CLS #2
20080 PAPER #3,3:PEN #3,0:CLS #3
20100 RETURN
20980 '<<<<<< inicializacion >>>>>>
21000 DIM d(10,7)
21010 DIM o$(11)
21020 DIM m(10,4)
21030 DIM o(11)
21100 RESTORE 21200
21110 FOR n=1 TO 10
21120 READ d(n,1),d(n,2),d(n,3),d(n,4)
21125 READ d(n,5),d(n,6),d(n,7)
21130 READ m(n,1),m(n,2),m(n,3),m(n,4)
21140 NEXT n
21150 FOR n=1 TO 11
21160 READ o$(n),o(n)
21170 NEXT n
21180 RETURN
21200 DATA 1,8,10,11,20,0,0
21205 DATA 0,0,0,0
21210 DATA 12,36,23,0,0,0,0
21215 DATA 1,1,0,0
21220 DATA 13,16,1,29,4,30,20
21225 DATA 1,0,1,0
21230 DATA 3,13,14,23,0,0,0
21235 DATA 0,1,1,0
21240 DATA 1,18,33,30,3,0,0
21245 DATA 0,1,0,0
21250 DATA 1,8,9,11,20,0,0
21255 DATA 0,0,0,0
21260 DATA 2,30,20,13,15,22,16
21265 DATA 1,0,1,1
21270 DATA 5,30,20,0,0,0,0
21275 DATA 0,0,1,0
21280 DATA 1,8,34,29,5,0,0
21285 DATA 1,0,0,1
21290 DATA 33,3,27,1,17,0,0
21295 DATA 0,0,1,0
21300 DATA CUCHILLO,6
21310 DATA LONA,1
21320 DATA AGUA EN CUBIERTA,2
21330 DATA CUERDA,6
21340 DATA CARTEL,8
21350 DATA CUBO,4
21360 DATA LLAVE,0
21370 DATA GATO,9
21380 DATA TRAPO,5
21390 DATA BOTAS DE AGUA,5
21400 DATA GANCHOS,0
21980 ' <<<<<< entrada >>>>>>>>
22000 m$="":PRINT #2:PRINT #2,">";
22010 a$=INKEY$:a$=UPPER$(a$)
22020 IF (a$<"A" OR a$>"Z") AND a$<>" " AND a$<>CHR$(13) AND a$<>CHR$(127) THEN GOTO 22010
22030 SOUND 1,150,2,15
22035 IF a$=CHR$(127) AND m$="" THEN GOTO 22010
22040 IF a$=CHR$(127) THEN m$=LEFT$(m$,LEN(m$)-1):PRINT #2,CHR$(8);" ";CHR$(8);:GOTO 22010
22050 IF a$=CHR$(13) THEN PRINT #2,CHR$(13):RETURN
22060 m$=m$+a$
22070 PRINT #2,a$;
22080 GOTO 22010
22980 REM <<<<<<<< inventario >>>>>>>>>>
23000 CLS #3
23010 PRINT #3,"INVENTARIO";
23020 PRINT #3,"=========="
23030 PRINT #3:PRINT #3
23040 FOR n=1 TO 11
23050 IF o(n)=13 THEN PRINT #3,o$(n)
23060 NEXT n
23070 RETURN
23980 REM <<<<<<<<<< split >>>>>>>>>>>>
24000 v$="":n$=""
24010 FOR n=1 TO LEN(m$)
24020 IF MID$(m$,n,1)=" " THEN GOTO 24060
24030 NEXT n
24040 v$=m$
24050 RETURN
24060 v$=LEFT$(m$,n-1)
24070 N$=RIGHT$(m$,LEN(m$)-n)
24080 RETURN
24980 REM <<<<<<<< comandos >>>>>>>>>
25000 GOSUB 22000
25010 GOSUB 24000
25020 C$=LEFT$(v$,2)
25030 IF C$="BA" THEN GOSUB 30000
25040 IF C$="ES" THEN GOSUB 31000
25050 IF C$="PR" THEN GOSUB 32000
25060 IF C$="PO" THEN GOSUB 33000
25080 IF C$="EN" OR C$="IR" THEN GOSUB 35000
25090 IF C$="EX" OR C$="MI" OR C$="IN" THEN GOSUB 36000
25100 IF C$="AB" THEN GOSUB 37000
25120 IF C$="SU" THEN GOSUB 39000
25130 IF C$="MA" OR C$="AS" THEN GOSUB 40000
25140 IF C$="LO" THEN GOSUB 40500
25150 IF C$="FU" OR C$="BE" OR C$="EM" THEN GOSUB 41000
25160 C$=LEFT(V$,3)
25170 IF C$="FRE" OR C$="LIM" THEN GOSUB 42000
25180 IF C$="MOV" OR C$="ALZ" THEN GOSUB 43000
25185 IF C$="COR" THEN GOSUB 38000
25187 IF C$="COG" THEN GOSUB 34000
25190 IF V$="FIN" THEN GOSUB 44000
25200 IF v$="^" THEN GOTO 25220
25210 PRINT #2,"No entiendo..."
25220 GOSUB 28000:GOSUB 23000
25230 GOTO 25000
25980 REM <<<<<<< comienzo >>>>>>>>>
26000 GOSUB 27000
26010 GOSUB 20000
26015 GOSUB 1000
26020 GOSUB 21000
26030 GOSUB 23000
26040 po=6
26100 RETURN
26980 REM <<<<<<<< cadenas >>>>>>>>>
27000 DIM w$(36)
27010 RESTORE 27060
27020 FOR n=1 TO 36
27030 READ w$(n)
27040 NEXT n
27050 RETURN
27060 DATA ESTOY,POPA,PROA,BABOR,ESTRIBOR,ARRIBA,ABAJO,EN,UN,PEQUEÑO,GRAN
27070 DATA "BOTE, AL LADO DE EL",HAY,EL VIENTO,AULLA,ULULA
27080 DATA SUENA COMO RISA.,FUERA,DENTRO,ES, MARIA CELESTE
27090 DATA UN,Y,AQUI.,Y YO,ME DESLIZO,A TRAVÉS,CERRADOS,ABIERTOS,HACIA,DE,ES,YO VEO ,ALMACENES
27100 DATA BOQUETE,EL,AGUA EN CUBIERTA,DIABLO,TRIANGULO DE LAS BERMUDAS,ATLANTIS
27980 REM <<<<<<<< describir >>>>>>>>>>
28000 CLS #1
28005 IF po=2 AND o(10)<>13 THEN PRINT #2,"Te deslizas hacia la siguiente":PRINT #2,"sección de cubierta !":po=3:SOUND 2,300,10,15
28007 IF po=1 AND o(2)=0 THEN GOTO 45000
28010 FOR n=1 TO 7
28020 PRINT #1,w$(d(po,n));" ";
28030 NEXT n
28040 PRINT #1
28050 PRINT #1
28060 PRINT #1," Puedo ver -"
28070 FOR n=1 TO 11
28080 IF o(n)=po THEN PRINT #1,o$(n);",";
28090 NEXT n
28100 RETURN
28980 REM <<<<<< comienzo de juego >>>>>>>>>
29000 GOSUB 26000
29010 GOSUB 28000
29020 GOTO 25000
29980 REM <<<<<<<< comandos >>>>>>>>
30000 v$="^"
30010 IF m(po,4)<>0 THEN GOTO 30020
30015 PRINT #2,"No puedes ir por ahí.":RETURN
30020 IF m(po,4)=1 THEN po=po-5:RETURN
30030 a=m(po,4):a=a-1:IF o(a)=13 THEN PRINT #2,"Usas ";o$(a):PRINT #2,"y vas hacia babor." ELSE GOTO 30015
30040 FOR n=1 TO 3000: NEXT n
30050 po=po-5:RETURN
31000 v$="^"
31010 IF m(po,2)<>0 THEN GOTO 31020
31015 PRINT #2,"No puedes ir por ahí.":RETURN
31020 IF m(po,2)=1 THEN po=po+5:RETURN
31030 a=m(po,2):a=a-1:IF o(a)=13 THEN PRINT #2,"Usas ";o$(a):PRINT #2,"y vas hacia estribor." ELSE GOTO 31015
31040 FOR n=1 TO 3000:NEXT n
31050 po=po+5:RETURN
32000 v$="^"
32010 IF m(po,1)<>0 THEN GOTO 32020
32015 PRINT #2,"No puedes ir por ahí.":RETURN
32020 IF m(po,1)=1 THEN po=po+1:RETURN
32030 a=m(po,1):a=a-1:IF o(a)=13 THEN PRINT #2,"Usas ";o$(a):PRINT #2,"y vas hacia proa." ELSE GOTO 32015
32040 FOR n=1 TO 3000: NEXT n
32050 po=po+1:RETURN
33000 v$="^"
33010 IF m(po,3)<>0 THEN GOTO 33020
